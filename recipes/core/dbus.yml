id: dbus
version: 1.12.20
about: |
  A message bus system, a simple way for applications to talk to one another

depends:
  runtime:
    - expat
    - systemd

  buildtime:
    - python

sources:
  - https://dbus.freedesktop.org/releases/dbus/dbus-1.12.20.tar.gz

packages:
  - id: pkg
    dir: dbus-1.12.20
    flags:
      - id: configurator
        value: configure

      - id: configure
        value: >
          --disable-static
          --disable-doxygen-docs
          --disable-xml-docs
          --with-console-auth-dir=/run/console
          --with-system-pid-file=/run/dbus/pid
          --with-system-socket=/run/dbus/system_bus_socket
          --libexecdir=/usr/lib/dbus-1.0
          --localstatedir=/var
          --enable-systemd
          --enable-user-session
          --without-x
          runstatedir=/run


    postscript: |
      mkdir -p ${pkgupd_pkgdir}/var/lib/dbus/
      ln -sfv /etc/machine-id ${pkgupd_pkgdir}/var/lib/dbus/
      rm -rf ${pkgupd_pkgdir}/var/run