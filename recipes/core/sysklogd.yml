id: sysklogd
version: 1.5.1
about: |
  Logging system messages, such as those given by the kernel

sources:
  - http://www.infodrom.org/projects/sysklogd/download/sysklogd-1.5.1.tar.gz

packages:
  - id: pkg
    dir: sysklogd-1.5.1
    plugin: script

    script: |
      sed -i "/Error loading kernel symbols/{n;n;d}" ksym_mod.c
      sed -i "s/union wait/int/" syslogd.c

      mkdir -p ${pkgupd_pkgdir}/{usr/bin,etc,usr/share/man/man{5,8}}

      make
      make BINDIR=${pkgupd_pkgdir}/usr/bin MANDIR=${pkgupd_pkgdir}/usr/share/man install

      cat > ${pkgupd_pkgdir}/etc/syslog.conf << "EOF"
      # Begin /etc/syslog.conf

      auth,authpriv.* -/var/log/auth.log
      *.*;auth,authpriv.none -/var/log/sys.log
      daemon.* -/var/log/daemon.log
      kern.* -/var/log/kern.log
      mail.* -/var/log/mail.log
      user.* -/var/log/user.log
      *.emerg *

      # End /etc/syslog.conf
      EOF