id: ncurses
version: 6.2
about: |
  Libraries for terminal-independent handling of character screens

depends:
  runtime:
    - glibc

sources:
  - https://ftp.gnu.org/gnu/ncurses/ncurses-6.2.tar.gz

packages:
  - id: pkg
    dir: ncurses-6.2
    flags:
      - id: configure
        value: >
          --with-shared
          --without-debug
          --without-normal
          --enable-pc-files
          --enable-widec

      - id: install
        value: DESTDIR=${pkgupd_pkgdir}

    postscript: |
      mkdir -p ${pkgupd_pkgdir}/usr/lib/pkgconfig

      for lib in ncurses form panel menu ; do
        rm -vf ${pkgupd_pkgdir}/usr/lib/lib${lib}.so
        echo "INPUT(-l${lib}w)" > ${pkgupd_pkgdir}/usr/lib/lib${lib}.so
        ln -sfv ${lib}w.pc        ${pkgupd_pkgdir}/usr/lib/pkgconfig/${lib}.pc
      done

      rm -vf                     ${pkgupd_pkgdir}/usr/lib/libcursesw.so
      echo "INPUT(-lncursesw)" > ${pkgupd_pkgdir}/usr/lib/libcursesw.so
      ln -sfv libncurses.so      ${pkgupd_pkgdir}/usr/lib/libcurses.so

      rm -fv ${pkgupd_pkgdir}/usr/lib/libncurses++w.a
